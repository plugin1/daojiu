<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å°çŒ«å†œåœº-å€’é…’æ¸¸æˆï¼</title>
<style>
body{font-family: "Segoe UI", "Microsoft YaHei", sans-serif;background:#fafafa;color:#111;padding:16px;}
.container{max-width:900px;margin:auto;background:#fff;padding:18px;border-radius:12px;box-shadow:0 6px 24px rgba(0,0,0,.06);}
h1{font-size:20px;margin-bottom:8px;}
p.lead{margin:4px 0 18px;color:#555;}
.controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:14px;}
button{padding:8px 12px;border-radius:8px;border:1px solid #ddd;background:#fff;cursor:pointer;}
button.primary{background:#0b76ff;color:#fff;border-color:#0b76ff;}
.question-box{margin-bottom:12px;}
.options{display:flex;gap:8px;flex-wrap:wrap;}
.option{flex:1;min-width:140px;border:1px solid #e6e6e6;padding:10px;border-radius:8px;text-align:center;cursor:pointer;background:#fcfcfc;}
.option.chosen{outline:3px solid rgba(11,118,255,.12);}
.small{font-size:13px;color:#666;}
.stats{margin-top:12px;}
textarea{width:100%;min-height:90px;}
footer{margin-top:14px;font-size:12px;color:#777;}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
<div class="container">
<h1>å°çŒ«å†œåœº-å€’é…’æ¸¸æˆï¼</h1>
<p class="lead">æ¯é¢˜ç»“ç®—ï¼</p>

<div class="controls">
<button id="prevBtn">â—€ ä¸Šä¸€é¢˜</button>
<button id="nextBtn" class="primary">ä¸‹ä¸€é¢˜ â–¶</button>
<button id="resetQuestion">é‡ç½®æœ¬é¢˜ç¥¨æ•°</button>
<button id="editBtn">âš™ ç¼–è¾‘é¢˜ç›®/é€‰é¡¹</button>
<button id="exportBtn">å¯¼å‡ºæ•°æ®ï¼ˆå¤åˆ¶ï¼‰</button>
<button id="importBtn">å¯¼å…¥æ•°æ®ï¼ˆç²˜è´´ï¼‰</button>
<button id="clearAll">æ¸…ç©ºå…¨éƒ¨æ•°æ®</button>
<button id="unlockVotes" style="font-size:16px;padding:2px 6px;border:none;background:none;cursor:pointer;">ğŸ</button>
</div>

<div class="question-box">
<div class="small">ç¬¬ <span id="qIndex">1</span> / å…± <span id="qCount">0</span> é¢˜</div>
<h2 id="questionTitle">è½½å…¥ä¸­...</h2>
<div class="small" id="optionsHint"></div>
</div>

<div class="options" id="options"></div>

<div class="stats">
<canvas id="chart" height="120"></canvas>
<div class="small" id="summary">æŠ•ç¥¨å°šæœªå¼€å§‹</div>
</div>

<div id="editPanel" style="display:none;margin-top:12px;">
<h3>ç¼–è¾‘é¢˜ç›®ä¸é€‰é¡¹</h3>
<textarea id="editQuestions" placeholder="æ¯è¡Œä¸€ä¸ªé—®é¢˜"></textarea>
<textarea id="editOptions" placeholder="æ¯è¡Œä¸€ä¸ªé€‰é¡¹ï¼Œå¦‚ï¼šFumika"></textarea>
<button id="saveEditBtn">ä¿å­˜ä¿®æ”¹</button>
</div>

<hr>
<textarea id="dataBox" placeholder="å¯¼å‡º/å¯¼å…¥ JSON æ•°æ®"></textarea>

<footer>å°çŒ«å†œåœº-å€’é…’æ¸¸æˆï¼by <a href="mailto:hopeaupl@gmail.com" style="color:#0b76ff;text-decoration:none;">PluGin1</a></footer>
</div>

<script>
// ========= é¢˜ç›®ä¸é€‰é¡¹ ==========
let QUESTIONS = [
'è°æœ€çˆ±åœ¨å…¬å…±åœºåˆåšè«åå…¶å¦™çš„äº‹','è°æœ€å¯èƒ½åœ¨å‡ºäº‹çš„æ—¶å€™å†²åœ¨å‰é¢','è°æœ€å¯èƒ½å…ˆæœ‰å°å­©','è°æœ€å¯èƒ½é…’åè”ç³»å‰ä»»','è°æœ€å®¹æ˜“è¢«PUA','è°æœ€æœ‰å¯èƒ½å…ˆç»“å©š','è°æœ€å–œæ¬¢å¹´ä¸‹','è°æœ€çˆ±çœ‹ç¾å¥³/å¸…å“¥','è°æœ€çˆ±å¿˜äº‹','è°æœ€å¯èƒ½ä¸€å¤œæƒ…','è°æœ€å®¹æ˜“å¿ƒåŠ¨','è°æœ€åƒM','è°æœ€å®¹æ˜“é‡ä¸Šæ¸£å¥³/ç”·','è°æœ€æœ‰ä¸Šè¿›å¿ƒ','è°æƒ…ç»ªæœ€ç¨³å®š','è°æœ€æœ‰å¯èƒ½åƒå›å¤´è‰','è°è„¾æ°”æœ€å¤§','è°æœ€å¯èƒ½ä¸ºçˆ±æ”¾å¼ƒäº‹ä¸š','è°æœ€å…«å¦','è°æœ€æ‹çˆ±è„‘','è°åˆ†æ‰‹åä¼šæœ€å¿«èµ°å‡ºæ¥','è°æœ€æœ‰æ¡ƒèŠ±'
];
let OPTIONS = ['Fumika','å°ç¾','ç›¼ç›¼','Selina','Zoe'];

// ========= çŠ¶æ€ç®¡ç† ==========
let state = loadState();
let qIndex = 0;
const STORAGE_KEY = 'daojiu_votes_v2';
let votedQuestions = JSON.parse(localStorage.getItem('votedQuestions')||'{}');
function saveVotedQuestions(){ localStorage.setItem('votedQuestions', JSON.stringify(votedQuestions)); }

// DOM
const qCountEl = document.getElementById('qCount');
const qIndexEl = document.getElementById('qIndex');
const questionTitle = document.getElementById('questionTitle');
const optionsDiv = document.getElementById('options');
const summary = document.getElementById('summary');
const dataBox = document.getElementById('dataBox');
const optionsHint = document.getElementById('optionsHint');
const editPanel = document.getElementById('editPanel');
const editQuestions = document.getElementById('editQuestions');
const editOptions = document.getElementById('editOptions');
qCountEl.textContent = QUESTIONS.length;
optionsHint.textContent = 'é€‰é¡¹ï¼š'+OPTIONS.join(' ');

// Firebase åˆå§‹åŒ–
const firebaseConfig = {
apiKey: "AIzaSyB5VcW8kGCWQrhOUV5-sq9NtTKzXHJAl78",
authDomain: "daojiu-f970e.firebaseapp.com",
databaseURL: "https://daojiu-f970e-default-rtdb.firebaseio.com",
projectId: "daojiu-f970e",
storageBucket: "daojiu-f970e.firebasestorage.app",
messagingSenderId: "438370344777",
appId: "1:438370344777:web:a2c0f25a6052b339d0c498"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Chart.js
const ctx = document.getElementById('chart').getContext('2d');
let chart;
function renderChart(counts){
  const labels = OPTIONS.slice();
  if(chart) chart.destroy();
  chart = new Chart(ctx,{type:'bar',data:{labels,datasets:[{label:'ç¥¨æ•°',data:counts}]},options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,precision:0}}}});
}

// çŠ¶æ€å‡½æ•°
function makeEmptyState(){ return {votes:QUESTIONS.map(()=>OPTIONS.map(()=>0)), currentQuestion:0}; }
function loadState(){ try{const raw=localStorage.getItem(STORAGE_KEY);return raw?JSON.parse(raw):makeEmptyState();}catch(e){return makeEmptyState();} }
function saveState(){ localStorage.setItem(STORAGE_KEY,JSON.stringify(state)); }

// æ˜¾ç¤ºé¢˜ç›®
function showQuestion(idx){
  qIndex = idx;
  qIndexEl.textContent = idx+1;
  questionTitle.textContent = QUESTIONS[idx]||'é¢˜ç›®ç¼ºå¤±';
  optionsDiv.innerHTML='';

  const voteRef = db.ref(`votes/${idx}`);
  voteRef.off();
  voteRef.on('value', snapshot=>{
    const counts = snapshot.val() || OPTIONS.map(()=>0);
    state.votes[idx] = counts;
    saveState();
    optionsDiv.innerHTML='';
    counts.forEach((c,i)=>{
      const btn = document.createElement('div');
      btn.className='option';
      btn.dataset.idx=i;
      btn.innerHTML=`<div style="font-weight:600">${OPTIONS[i]}</div><div class="small">ç‚¹å‡»æŠ•ç¥¨</div>`;
      if(votedQuestions[idx]){
        btn.style.opacity=0.6;
        btn.style.pointerEvents='none';
        btn.querySelector('.small').textContent='å·²æŠ•ç¥¨';
      }else{
        btn.addEventListener('click',()=>{ submitVote(i); checkVoteEnd(); });
      }
      optionsDiv.appendChild(btn);
    });
    renderChart(counts);
    const total = counts.reduce((a,b)=>a+b,0);
    summary.textContent = `æ€»ç¥¨æ•°ï¼š${total}ï¼ˆ${counts.map((c,i)=>OPTIONS[i]+':'+c).join(' ï¼ ')}ï¼‰`;
  });
}

// æŠ•ç¥¨
function submitVote(optionIdx){
  if(votedQuestions[qIndex]){ alert('æ¯é¢˜æ¯äººåªèƒ½æŠ•ä¸€æ¬¡'); return; }
  state.votes[qIndex][optionIdx]+=1;
  saveState();
  const votePath = `votes/${qIndex}/${optionIdx}`;
  db.ref(votePath).transaction(current=>(current||0)+1);
  votedQuestions[qIndex]=true;
  saveVotedQuestions();
}

// ä¸‹ä¸€é¢˜/ä¸Šä¸€é¢˜
document.getElementById('nextBtn').addEventListener('click',()=>{ if(qIndex<QUESTIONS.length-1) qIndex++; showQuestion(qIndex); });
document.getElementById('prevBtn').addEventListener('click',()=>{ if(qIndex>0) qIndex--; showQuestion(qIndex); });

// é‡ç½®æœ¬é¢˜ç¥¨æ•°
document.getElementById('resetQuestion').addEventListener('click',()=>{ 
  if(confirm('ç¡®å®šé‡ç½®æœ¬é¢˜ç¥¨æ•°å—ï¼Ÿ')){ 
    state.votes[qIndex]=OPTIONS.map(()=>0); 
    saveState(); 
    db.ref(`votes/${qIndex}`).set(OPTIONS.map(()=>0));
    delete votedQuestions[qIndex]; 
    saveVotedQuestions();
    showQuestion(qIndex); 
  } 
});

// æ¸…ç©ºå…¨éƒ¨æ•°æ®
document.getElementById('clearAll').addEventListener('click',()=>{ 
  if(confirm('ç¡®å®šæ¸…ç©ºå…¨éƒ¨æ•°æ®ï¼Ÿ')){ 
    state=makeEmptyState(); 
    saveState(); 
    QUESTIONS.forEach((_,idx)=>db.ref(`votes/${idx}`).set(OPTIONS.map(()=>0)));
    votedQuestions={}; 
    saveVotedQuestions();
    showQuestion(0); 
  } 
});

// å¯¼å‡º/å¯¼å…¥
document.getElementById('exportBtn').addEventListener('click',()=>{
  dataBox.value=JSON.stringify(state); dataBox.select();
  try{document.execCommand('copy'); alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');}catch(e){alert('è¯·æ‰‹åŠ¨å¤åˆ¶');}
});
document.getElementById('importBtn').addEventListener('click',()=>{
  const raw=dataBox.value.trim(); if(!raw){alert('è¯·å…ˆç²˜è´´ JSON æ•°æ®'); return;}
  try{
    const obj=JSON.parse(raw);
    if(!obj.votes||!Array.isArray(obj.votes)||obj.votes.length!==QUESTIONS.length)throw'æ ¼å¼é”™è¯¯';
    state=obj; saveState(); showQuestion(qIndex); alert('å·²å¯¼å…¥æ•°æ®');
  }catch(e){alert('å¯¼å…¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ JSON æ ¼å¼');}
});

// ğŸæŒ‰é’®ï¼ˆæŠ•ç©ºç¥¨+è§£é”æµ‹è¯•ï¼‰
const appleBtn=document.getElementById('unlockVotes');
appleBtn.addEventListener('click',()=>{
  const menu=document.createElement('div');
  menu.style.position='fixed';
  menu.style.bottom='40px';
  menu.style.right='8px';
  menu.style.background='#fff';
  menu.style.border='1px solid #ddd';
  menu.style.borderRadius='8px';
  menu.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';
  menu.style.zIndex='10001';
  menu.style.padding='4px 0';
  menu.style.display='flex';
  menu.style.flexDirection='column';

  // æŠ•ç©ºç¥¨ï¼ˆå ä½ï¼‰
  const emptyVoteBtn=document.createElement('button');
  emptyVoteBtn.textContent='æŠ•ç©ºç¥¨ï¼ˆå ä½ï¼‰';
  emptyVoteBtn.style.padding='4px 8px';
  emptyVoteBtn.style.border='none';
  emptyVoteBtn.style.background='none';
  emptyVoteBtn.style.cursor='pointer';
  emptyVoteBtn.addEventListener('click',()=>{
    if(votedQuestions[qIndex]){ alert('æœ¬é¢˜å·²æŠ•ç¥¨'); menu.remove(); return;}
    state.votes[qIndex][0]+=1; // é»˜è®¤å ä½ç¥¨æŠ•ç»™ç¬¬ä¸€ä¸ªé€‰é¡¹
    saveState();
    const votePath=`votes/${qIndex}/0`;
    db.ref(votePath).transaction(current=>(current||0)+1);
    votedQuestions[qIndex]=true; saveVotedQuestions();
    showQuestion(qIndex); alert('æœ¬é¢˜å·²æŠ•å ä½ç¥¨'); menu.remove();
  });
  menu.appendChild(emptyVoteBtn);

  // æµ‹è¯•è§£é”
  const unlockBtn=document.createElement('button');
  unlockBtn.textContent='è§£é”æœ¬é¢˜æŠ•ç¥¨ï¼ˆæµ‹è¯•ï¼‰';
  unlockBtn.style.padding='4px 8px';
  unlockBtn.style.border='none';
  unlockBtn.style.background='none';
  unlockBtn.style.cursor='pointer';
  unlockBtn.addEventListener('click',()=>{
    delete votedQuestions[qIndex]; saveVotedQuestions(); showQuestion(qIndex); menu.remove();
  });
  menu.appendChild(unlockBtn);

  document.body.appendChild(menu);
  const handler=e=>{ if(!menu.contains(e.target)&&e.target!==appleBtn){menu.remove();document.removeEventListener('click',handler);}};
  document.addEventListener('click',handler);
});

// ç¼–è¾‘é¢˜ç›®/é€‰é¡¹
document.getElementById('editBtn').addEventListener('click',()=>{ 
  editPanel.style.display=editPanel.style.display==='none'?'block':'none'; 
  editQuestions.value=QUESTIONS.join('\n'); 
  editOptions.value=OPTIONS.join('\n'); 
});
document.getElementById('saveEditBtn').addEventListener('click',()=>{
  const qText=editQuestions.value.split('\n').map(l=>l.trim()).filter(Boolean);
  const oText=editOptions.value.split('\n').map(l=>l.trim()).filter(Boolean);
  if(qText.length<1||oText.length<1){alert('é¢˜ç›®å’Œé€‰é¡¹éƒ½ä¸èƒ½ä¸ºç©º'); return;}
  QUESTIONS=qText; OPTIONS=oText;
  state.votes=QUESTIONS.map((q,i)=>state.votes[i]||OPTIONS.map(()=>0));
  qCountEl.textContent=QUESTIONS.length;
  optionsHint.textContent='é€‰é¡¹ï¼š'+OPTIONS.join(' ');
  saveState();
  showQuestion(0);
});

// MVPç»“ç®—
function checkVoteEnd(){
  const totalVotes = state.votes.flat().filter(v=>v!==null && v!==undefined).reduce((a,b)=>a+b,0);
  if(totalVotes>=5){ showMVP(); }
}
function showMVP(){
  const counts={};
  state.votes.forEach(vArr=>{
    vArr.forEach((v,i)=>{ if(v!==null && v!==undefined) counts[OPTIONS[i]]=(counts[OPTIONS[i]]||0)+v; });
  });
  const maxName=Object.keys(counts).reduce((a,b)=> counts[a]>counts[b]?a:b);
  const mvpDiv=document.createElement('div');
  mvpDiv.style.position='fixed';
  mvpDiv.style.left='0';
  mvpDiv.style.top='0';
  mvpDiv.style.width='100%';
  mvpDiv.style.height='100%';
  mvpDiv.style.background='rgba(255,255,255,0.9)';
  mvpDiv.style.display='flex';
  mvpDiv.style.flexDirection='column';
  mvpDiv.style.justifyContent='center';
  mvpDiv.style.alignItems='center';
  mvpDiv.style.zIndex='9999';
  const questionText = QUESTIONS[qIndex]||'é¢˜ç›®ç¼ºå¤±';
  mvpDiv.innerHTML=`<h2 style="font-size:24px;color:#999;">ğŸ† æœ¬é¢˜ç»“ç®—ï¼š${questionText}</h2><h1 style="font-size:48px;color:#ff007f;text-shadow:0 0 12px #ff66b2;animation: glow 3s infinite alternate;">${maxName}</h1>`;
  document.body.appendChild(mvpDiv);
  startFireworks();
  setTimeout(()=>mvpDiv.remove(),8000);
}

function startFireworks(){
  const canvas=document.createElement('canvas');
  canvas.style.position='fixed';
  canvas.style.left='0';
  canvas.style.top='0';
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
  canvas.style.zIndex='10000';
  document.body.appendChild(canvas);
  const ctx=canvas.getContext('2d');
  const particles=[];
  function addParticle(){ particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height/2,vx:(Math.random()-0.5)*3,vy:Math.random()*-2-2,life:80}); }
  function update(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    particles.forEach(p=>{p.x+=p.vx;p.y+=p.vy;p.vy+=0.05;p.life--;ctx.fillStyle=`hsl(${Math.random()*360},100%,60%)`;ctx.beginPath();ctx.arc(p.x,p.y,3,0,Math.PI*2);ctx.fill();});
    for(let i=0;i<5;i++) addParticle();
    for(let i=particles.length-1;i>=0;i--) if(particles[i].life<=0) particles.splice(i,1);
    requestAnimationFrame(update);
  }
  update();
  setTimeout(()=>canvas.remove(),8000);
}

// åˆå§‹åŒ–
showQuestion(0);
</script>
</body>
</html>
  menu.appendChild(emptyVoteBtn);

  // æµ‹è¯•ç”¨è§£é”æŒ‰é’®
  const unlockBtn = document.createElement('button');
  unlockBtn.textContent = 'è§£é”æœ¬é¢˜æŠ•ç¥¨ï¼ˆæµ‹è¯•ï¼‰';
  unlockBtn.style.padding = '4px 8px';
  unlockBtn.style.border = 'none';
  unlockBtn.style.background = 'none';
  unlockBtn.style.cursor = 'pointer';
  unlockBtn.addEventListener('click', () => {
    delete votedQuestions[qIndex];
    saveVotedQuestions();
    showQuestion(qIndex);
    console.log('æœ¬é¢˜æŠ•ç¥¨å·²è§£é”ï¼ˆæµ‹è¯•ç”¨ï¼‰');
    menu.remove();
  });
  menu.appendChild(unlockBtn);

  document.body.appendChild(menu);

  // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
  const handler = e => {
    if(!menu.contains(e.target) && e.target !== appleBtn){
      menu.remove();
      document.removeEventListener('click', handler);
    }
  };
  document.addEventListener('click', handler);
});

// ç¼–è¾‘é¢˜ç›®/é€‰é¡¹
document.getElementById('editBtn').addEventListener('click',()=>{ editPanel.style.display=editPanel.style.display==='none'?'block':'none'; editQuestions.value=QUESTIONS.join('\n'); editOptions.value=OPTIONS.join('\n'); });
document.getElementById('saveEditBtn').addEventListener('click',()=>{
  const qText = editQuestions.value.split('\n').map(l=>l.trim()).filter(Boolean);
  const oText = editOptions.value.split('\n').map(l=>l.trim()).filter(Boolean);
  if(qText.length<1||oText.length<1){ alert('é¢˜ç›®å’Œé€‰é¡¹éƒ½ä¸èƒ½ä¸ºç©º'); return; }
  QUESTIONS=qText; OPTIONS=oText;
  // è°ƒæ•´ votes
  state.votes=QUESTIONS.map((q,i)=>state.votes[i]||OPTIONS.map(()=>0));
  qCountEl.textContent=QUESTIONS.length;
  optionsHint.textContent='é€‰é¡¹ï¼š'+OPTIONS.join(' ');
  saveState();
  showQuestion(0);
});

  // ======== MVP ç»“ç®—ä¸åŠ¨ç”» ========
function checkVoteEnd(){
  // æ£€æŸ¥æ˜¯å¦æŠ•å¤Ÿ5ç¥¨
  const totalVotes = Object.values(state.votes || {}).filter(v => v !== null && v !== undefined).length;
  if(totalVotes >= 5){
    showMVP();
  }
}

function showMVP(){
  // æ‰¾åˆ°ç¥¨æ•°æœ€é«˜çš„é€‰é¡¹
  const counts = {};
  Object.values(state.votes).forEach(v=>{
    if(v!==null && v!==undefined){
      counts[v] = (counts[v] || 0) + 1;
    }
  });
  const maxName = Object.keys(counts).reduce((a,b)=> counts[a]>counts[b]?a:b);
  
  const mvpDiv = document.createElement('div');
  mvpDiv.style.position = 'fixed';
  mvpDiv.style.left = '0';
  mvpDiv.style.top = '0';
  mvpDiv.style.width = '100%';
  mvpDiv.style.height = '100%';
  mvpDiv.style.background = 'rgba(255,255,255,0.9)';
  mvpDiv.style.display = 'flex';
  mvpDiv.style.flexDirection = 'column';
  mvpDiv.style.justifyContent = 'center';
  mvpDiv.style.alignItems = 'center';
  mvpDiv.style.zIndex = '9999';
 // æ‰¾åˆ°æœ¬é¢˜é¢˜å¹²
const questionText = QUESTIONS[qIndex] || 'é¢˜ç›®ç¼ºå¤±';
mvpDiv.innerHTML = `
  <h2 style="font-size:24px;color:#999;">ğŸ† æœ¬é¢˜ç»“ç®—ï¼š${questionText}</h2>
  <h1 style="font-size:48px;color:#ff007f;text-shadow:0 0 12px #ff66b2;animation: glow 3s infinite alternate;">${maxName}</h1>
`;

  document.body.appendChild(mvpDiv);

  startFireworks();
  setTimeout(()=>mvpDiv.remove(),8000); // 8ç§’åè‡ªåŠ¨æ¶ˆå¤±
}

function startFireworks(){
  const canvas = document.createElement('canvas');
  canvas.style.position = 'fixed';
  canvas.style.left = '0';
  canvas.style.top = '0';
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  canvas.style.zIndex = '10000';
  document.body.appendChild(canvas);
  const ctx = canvas.getContext('2d');
  const particles = [];

  function addParticle(){
    particles.push({
      x: Math.random()*canvas.width,
      y: Math.random()*canvas.height/2,
      vx: (Math.random()-0.5)*3,
      vy: Math.random()*-2-2,
      life: 80
    });
  }
  function update(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    particles.forEach(p=>{
      p.x+=p.vx; p.y+=p.vy; p.vy+=0.05; p.life--;
      ctx.fillStyle=`hsl(${Math.random()*360},100%,60%)`;
      ctx.beginPath();
      ctx.arc(p.x,p.y,3,0,Math.PI*2);
      ctx.fill();
    });
    for(let i=0;i<5;i++) addParticle();
    for(let i=particles.length-1;i>=0;i--) if(particles[i].life<=0) particles.splice(i,1);
    requestAnimationFrame(update);
  }
  update();
  setTimeout(()=>canvas.remove(),8000);
}

// åˆå§‹åŒ–
showQuestion(0);
</script>
</body>
</html>
